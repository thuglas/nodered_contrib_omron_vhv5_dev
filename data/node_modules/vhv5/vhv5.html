<script type="text/html" data-template-name="vhv5">

  <div class="form-row">
    <label for="node-input-name"><i class="fa fa-tag"></i>Name</label>
    <input type="text" id="node-input-name" data-il8n="[placeholder]node-red:common.label.name">
  </div>
  <div class="form-row">
    <label for="node-input-ipAddress">IP Address</label>
    <input type="text" id="node-input-ipAddress" placeholder="Enter IP Address" />
  </div>
  <div class="form-row">
        <label for="node-input-displaytriggerbutton">Display Trigger Button</label>
        <input type="checkbox" id="node-input-displaytriggerbutton"/>
  </div>
</script>
<script type="text/javascript">
RED.nodes.registerType('vhv5',{
    category: 'network',
    defaults:{
      name: {value:""},
	    ipAddress: {value: "192.168.250.19"},
      displaytriggerbutton: {value: false}
    },
    color:"rgb(160,160, 255)",
    inputs:0,
    outputs:3,
    icon: "white-globe.svg",
    label: function() {
      return this.name||"VHV5";   //this._("comment.comment");
    },
    labelStyle: function() {
      return this.name?"node_label_italic":"";
    },
    outputLabels: ["ReaderReport msg","sysinfo msg", "all other msgs"],
    button: {
      visible:  function() {
        return this.displaytriggerbutton;
      },
      onclick:  function() {
        //const hr = new XMLHttpRequest();
        //hr.open("PUT", `http://${this.ipAddress}/api/control/trigger`, true);
        //hr.setRequestHeader("Content-Type","application/json");
        //hr.send("");
        RED.httpAdmin.get("/triggerVHV5", RED.auth.needsPermission('vhv5.trigger'), function(req, res) {
          res.json({ status: 'success' });
        });
      }
    }
});
</script>





